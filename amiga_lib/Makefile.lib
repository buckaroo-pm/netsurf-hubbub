# Makefile for project "parserutils"
# Automatically generated by idltool
# 
# $Id$
# 

# Uncomment the next line if you are cross compiling
# CROSS_COMPILE = ppc-amigaos-

CC     = $(CROSS_COMPILE)gcc 
CXX    = $(CROSS_COMPILE)c++ 
AS     = $(CROSS_COMPILE)as 
LD     = $(CROSS_COMPILE)ld 
RANLIB = $(CROSS_COMPILE)ranlib 
RM     = delete
# RM     = rm

# Change these as required
OPTIMIZE = -O3
DEBUG    = # -gstabs -DDEBUG
CFLAGS   = -Wall $(OPTIMIZE) $(DEBUG) -Iinclude -I../include

# Flags passed to gcc during linking
LINK = 

# Name of the "thing" to build
TARGET = hubbub.library

# Additional linker libraries
LIBS = ../build-Amiga-Amiga-release-lib-static/libhubbub.a -lparserutils

# Version of the library to build
VERSION = 2

STUBS = stubs/auto.c stubs/funcs.c

# -------------------------------------------------------------
# Nothing should need changing below this line

SRCS = init.c

OBJS = $(SRCS:.c=.o)
# Rules for building
$(TARGET): $(OBJS)
	$(CC) $(LINK) -nostartfiles -o $(TARGET) $(OBJS) $(LIBS)
	strip $(TARGET)
	copy $(TARGET) libs:

libhubbub.so: $(STUBS:.c=.o)
	$(CC) -N -fPIC -shared -Wl,-soname,libhubbub.so.0 -o $@ $^

libhubbub.a: libhubbub.a.debug
	strip -S -R.comment $< -o $@

libhubbub.a.debug: $(STUBS:.c=.o)
	rm -f $@
	ar cru $@ $^

.PHONY: clean
clean:
	$(RM) $(TARGET) $(OBJS)

.PHONY: revision
revision:
	bumprev $(VERSION) $(TARGET)

